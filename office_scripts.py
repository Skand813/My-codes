

#to find matching profile from Canada and Australia
import pandas as pd
data2=pd.read_csv(r'/Users/smani/Documents/op_file.csv')
print(len(df2))
keys=list(data['prim_key'])
locs=list(data['loc'])
listx = ['Canberra', 'Sydney', 'Albury', 'Armidale', 'Bathurst', 'Blue Mountains', 'Broken Hill', 'Campbelltown', 'Cessnock', 'Dubbo', 'Goulburn', 'Grafton', 'Lithgow', 'Liverpool', 'Newcastle', 'Orange', 'Parramatta', 'Penrith', 'Queanbeyan', 'Tamworth', 'Wagga Wagga', 'Wollongong', 'City of Blacktown', 'City of Canada Bay', 'City of Coffs Harbour', 'City of Fairfield', 'City of Griffith', 'City of Hawkesbury', 'City of Lake Macquarie', 'City of Lismore', 'City of Maitland', 'City of Randwick', 'City of Ryde', 'City of Shellharbour', 'City of Shoalhaven', 'City of Willoughby', 'City of Bankstown', 'City of Botany Bay', 'City of Canterbury', 'City of Dubbo', 'City of Gosford', 'City of Greater Taree', 'City of Holroyd', 'City of Hurstville', 'City of Queanbeyan', 'City of Rockdale', 'Darwin', 'Palmerston', 'Brisbane', 'Bundaberg', 'Caboolture', 'Cairns', 'Caloundra', 'Gladstone', 'Gold Coast', 'Gympie', 'Hervey Bay', 'Ipswich', 'Logan City', 'Mackay', 'Maryborough', 'Mount Isa', 'Rockhampton', 'Sunshine Coast', 'Toowoomba', 'Townsville', 'Charters Towers', 'Redcliffe City', 'Redland City', 'Thuringowa', 'Warwick', 'Adelaide', 'Mount Barker', 'Mount Gambier', 'Murray Bridge', 'Port Adelaide', 'Port Augusta', 'Port Pirie', 'Port Lincoln', 'Victor Harbor', 'Whyalla', 'Hobart', 'conurbation', 'City of Clarence', 'City of Hobart', 'City of Glenorchy', 'Burnie', 'Devonport', 'Launceston', 'Melbourne', 'Ararat', 'Bairnsdale', 'Benalla', 'Ballarat', 'Bendigo', 'Dandenong', 'Frankston', 'Geelong', 'Hamilton', 'Horsham', 'Latrobe City', 'Melton', 'Mildura', 'Sale', 'Shepparton', 'Swan Hill', 'Wangaratta', 'Warrnambool', 'Wodonga', 'Perth', 'Albany', 'Bunbury', 'Busselton', 'Fremantle', 'Geraldton', 'Joondalup', 'Kalgoorlie', 'Karratha', 'Mandurah', 'Rockingham', 'City of Armadale', 'City of Bayswater', 'City of Canning', 'City of Cockburn', 'City of Gosnells', 'City of Kalamunda', 'City of Kwinana', 'City of Melville', 'City of Nedlands', 'City of South Perth', 'City of Stirling', 'City of Subiaco', 'City of Swan', 'City of Wanneroo','Alberta', 'Edmonton', 'British Columbia', 'Victoria', 'Manitoba', 'Winnipeg', 'New Brunswick', 'Fredericton', 'Newfoundland and Labrador', "St. John's", 'Nova Scotia', 'Halifax', 'Ontario', 'Toronto', 'Prince Edward Island', 'Charlottetown', 'Quebec', 'Quebec City', 'Saskatchewan', 'Regina', 'Northwest Territories', 'Yellowknife', 'Nunavut', 'Iqaluit', 'Yukon', 'Whitehorse', 'Airdrie', 'Beaumont', 'Brooks', 'Calgary', 'Camrose', 'Chestermere', 'Cold Lake', 'Edmonton', 'Fort Saskatchewan', 'Grande Prairie', 'Lacombe', 'Leduc', 'Lethbridge', 'Lloydminster', 'Medicine Hat', 'Red Deer', 'Spruce Grove', 'St. Albert', 'Wetaskiwin', 'Abbotsford', 'Fraser Valley', 'Armstrong', 'North Okanagan', 'Burnaby', 'Metro Vancouver', 'Campbell River', 'Strathcona', 'Castlegar', 'Central Kootenay', 'Chilliwack', 'Colwood', 'Capital', 'Coquitlam', 'Courtenay', 'Comox Valley', 'Cranbrook', 'East Kootenay', 'Dawson Creek', 'Peace River', 'Delta', 'Duncan', 'Cowichan Valley', 'Enderby', 'Fernie', 'Fort St. John', 'Grand Forks', 'Kootenay Boundary', 'Greenwood', 'Kamloops', 'Thompson-Nicola', 'Kelowna', 'Central Okanagan', 'Kimberley', 'Langford', 'Langley', 'Maple Ridge', 'Merritt', 'Nanaimo', 'Nanaimo', 'Nelson', 'New Westminster', 'North Vancouver', 'Parksville', 'Penticton', 'Okanagan-Similkameen', 'Pitt Meadows', 'Port Alberni', 'Alberni-Clayoquot', 'Port Coquitlam', 'Port Moody', 'Powell River', 'Powell River', 'Prince George', 'Fraser-Fort George', 'Prince Rupert', 'North Coast', 'Quesnel', 'Cariboo', 'Revelstoke', 'Columbia Shuswap', 'Richmond', 'Rossland', 'Salmon Arm', 'Surrey', 'Terrace', 'Kitimat-Stikine', 'Trail', 'Vancouver', 'Vernon', 'Victoria', 'West Kelowna', 'White Rock', 'Williams Lake', 'Brandon', 'Dauphin', 'Flin Flon', 'Morden', 'Portage la Prairie', 'Selkirk', 'Steinbach', 'Thompson', 'Winkler', 'Winnipeg', 'Bathurst', 'Campbellton', 'Dieppe', 'Edmundston', 'Fredericton', 'Miramichi', 'Moncton', 'Saint John', 'Corner Brook', 'Mount Pearl', "St. John's", 'Yellowknife', 'Iqaluit', 'Barrie', 'Belleville', 'Brampton', 'Brant', 'Brantford', 'Brockville', 'Burlington', 'Cambridge', 'Clarence-Rockland', 'Cornwall', 'Dryden', 'Elliot Lake', 'Greater Sudbury', 'Guelph', 'Haldimand County', 'Hamilton', 'Kawartha Lakes', 'Kenora', 'Kingston', 'Kitchener', 'London', 'Markham', 'Mississauga', 'Niagara Falls', 'Norfolk County', 'North Bay', 'Orillia', 'Oshawa', 'Ottawa', 'Owen Sound', 'Pembroke', 'Peterborough', 'Pickering', 'Port Colborne', 'Prince Edward County', 'Quinte West', 'Richmond Hill', 'Sarnia', 'Sault Ste. Marie', 'St. Catharines', 'St. Thomas', 'Stratford', 'Temiskaming Shores', 'Thorold', 'Thunder Bay', 'Timmins', 'Toronto', 'Vaughan', 'Waterloo', 'Welland', 'Windsor', 'Woodstock', 'Charlottetown', 'Queens', 'Summerside', 'Prince', 'Acton Vale', 'Acton', 'Montérégie', 'Alma', 'Lac-Saint-Jean-Est', 'Saguenay–Lac-Saint-Jean', 'Amos', 'Abitibi', 'Abitibi-Témiscamingue', 'Amqui', 'La Matapédia', 'Bas-Saint-Laurent', 'Baie-Comeau', 'Manicouagan', 'Côte-Nord', "Baie-D'Urfé", 'Montréal', 'Montréal', 'Baie-Saint-Paul', 'Charlevoix', 'Capitale-Nationale', 'Barkmere', 'Les Laurentides', 'Laurentides', 'Beaconsfield', 'Montréal', 'Montréal', 'Beauceville', 'Robert-Cliche', 'Chaudière-Appalaches', 'Beauharnois', 'Beauharnois-Salaberry', 'Montérégie', 'Montréal', 'Beaupré', 'La Côte-de-Beaupré', 'Capitale-Nationale', 'Bécancour', 'Bécancour', 'Centre-du-Québec', 'Bedford', 'Brome-Missisquoi', 'Montérégie', 'Belleterre', 'Témiscamingue', 'Abitibi-Témiscamingue', 'Beloeil', 'La Vallée-du-Richelieu', 'Montérégie', 'Montréal', 'Berthierville', "D'Autray", 'Lanaudière', 'Blainville', 'Thérèse-De Blainville', 'Laurentides', 'Montréal', 'Boisbriand', 'Thérèse-De Blainville', 'Laurentides', 'Montréal', 'Bois-des-Filion', 'Thérèse-De Blainville', 'Laurentides', 'Montréal', 'Bonaventure', 'Bonaventure', 'Gaspésie–Îles-de-la-Madeleine', 'Boucherville', 'Montérégie', 'Montréal', 'Lac-Brome', 'Brome-Missisquoi', 'Montérégie', 'Bromont', 'Brome-Missisquoi', 'Montérégie', 'Brossard', 'Montérégie', 'Montréal', 'Brownsburg-Chatham', 'Argenteuil', 'Laurentides', 'Candiac', 'Roussillon', 'Montérégie', 'Montréal', 'Cap-Chat', 'La Haute-Gaspésie', 'Gaspésie–Îles-de-la-Madeleine', 'Cap-Santé', 'Portneuf', 'Capitale-Nationale', 'Carignan', 'La Vallée-du-Richelieu', 'Montérégie', 'Montréal', 'Carleton-sur-Mer', 'Avignon', 'Gaspésie–Îles-de-la-Madeleine', 'Causapscal', 'La Matapédia', 'Bas-Saint-Laurent', 'Chambly', 'La Vallée-du-Richelieu', 'Montérégie', 'Montréal', 'Chandler', 'Le Rocher-Percé', 'Gaspésie–Îles-de-la-Madeleine', 'Chapais', 'Nord-du-Québec', 'Charlemagne', "L'Assomption", 'Lanaudière', 'Montréal', 'Châteauguay', 'Roussillon', 'Montérégie', 'Montréal', 'Château-Richer', 'La Côte-de-Beaupré', 'Capitale-Nationale', 'Québec', 'Chibougamau', 'Nord-du-Québec', 'Clermont', 'Charlevoix-Est', 'Capitale-Nationale', 'Coaticook', 'Coaticook', 'Estrie', 'Contrecoeur', "Marguerite-D'Youville", 'Montérégie', 'Cookshire-Eaton', 'Le Haut-Saint-François', 'Estrie', 'Côte Saint-Luc', 'Montréal', 'Montréal', 'Coteau-du-Lac', 'Vaudreuil-Soulanges', 'Montérégie', 'Montréal', 'Cowansville', 'Brome-Missisquoi', 'Montérégie', 'Danville', 'Les Sources', 'Estrie', 'Daveluyville', 'Arthabaska', 'Centre-du-Québec', 'Dégelis', 'Témiscouata', 'Bas-Saint-Laurent', 'Delson', 'Roussillon', 'Montérégie', 'Montréal', 'Desbiens', 'Lac-Saint-Jean-Est', 'Saguenay–Lac-Saint-Jean', 'Deux-Montagnes', 'Deux-Montagnes', 'Laurentides', 'Montréal', 'Disraeli', 'Les Appalaches', 'Chaudière-Appalaches', 'Dolbeau-Mistassini', 'Maria-Chapdelaine', 'Saguenay–Lac-Saint-Jean', 'Dollard-des-Ormeaux', 'Montréal', 'Montréal', 'Donnacona', 'Portneuf', 'Capitale-Nationale', 'Dorval', 'Montréal', 'Montréal', 'Drummondville', 'Drummond', 'Centre-du-Québec', 'Dunham', 'Brome-Missisquoi', 'Montérégie', 'Duparquet', 'Abitibi-Ouest', 'Abitibi-Témiscamingue', 'East Angus', 'Le Haut-Saint-François', 'Estrie', 'Estérel', "Les Pays-d'en-Haut", 'Laurentides', 'Farnham', 'Brome-Missisquoi', 'Montérégie', 'Fermont', 'Caniapiscau', 'Côte-Nord', 'Forestville', 'La Haute-Côte-Nord', 'Côte-Nord', 'Fossambault-sur-le-Lac', 'La Jacques-Cartier', 'Capitale-Nationale', 'Québec', 'Gaspé', 'La Côte-de-Gaspé', 'Gaspésie–Îles-de-la-Madeleine', 'Gatineau', 'Outaouais', 'Ottawa - Gatineau', 'Gracefield', 'La Vallée-de-la-Gatineau', 'Outaouais', 'Granby', 'La Haute-Yamaska', 'Montérégie', 'Grande-Rivière', 'Le Rocher-Percé', 'Gaspésie–Îles-de-la-Madeleine', 'Hampstead', 'Montréal', 'Montréal', 'Hudson', 'Vaudreuil-Soulanges', 'Montérégie', 'Montréal', 'Huntingdon', 'Le Haut-Saint-Laurent', 'Montérégie', 'Joliette', 'Joliette', 'Lanaudière', 'Kingsey Falls', 'Arthabaska', 'Centre-du-Québec', 'Kirkland', 'Montréal', 'Montréal', 'La Malbaie', 'Charlevoix-Est', 'Capitale-Nationale', 'La Pocatière', 'Kamouraska', 'Bas-Saint-Laurent', 'La Prairie', 'Roussillon', 'Montérégie', 'Montréal', 'La Sarre', 'Abitibi-Ouest', 'Abitibi-Témiscamingue', 'La Tuque', 'Mauricie', 'Lac-Delage', 'La Jacques-Cartier', 'Capitale-Nationale', 'Québec', 'Lachute', 'Argenteuil', 'Laurentides', 'Lac-Mégantic', 'Le Granit', 'Estrie', 'Lac-Saint-Joseph', 'La Jacques-Cartier', 'Capitale-Nationale', 'Québec', 'Lac-Sergent', 'Portneuf', 'Capitale-Nationale', "L'Ancienne-Lorette", 'Capitale-Nationale', 'Québec', "L'Assomption", "L'Assomption", 'Lanaudière', 'Montréal', 'Laval', 'Laval', 'Montréal', 'Lavaltrie', "D'Autray", 'Lanaudière', 'Montréal', 'Lebel-sur-Quévillon', 'Nord-du-Québec', "L'Épiphanie", "L'Assomption", 'Lanaudière', 'Montréal', 'Léry', 'Roussillon', 'Montérégie', 'Montréal', 'Lévis', 'Chaudière-Appalaches', 'Québec', "L'Île-Cadieux", 'Vaudreuil-Soulanges', 'Montérégie', 'Montréal', "L'Île-Dorval", 'Montréal', 'Montréal', "L'Île-Perrot", 'Vaudreuil-Soulanges', 'Montérégie', 'Montréal', 'Longueuil', 'Montérégie', 'Montréal', 'Lorraine', 'Thérèse-De Blainville', 'Laurentides', 'Montréal', 'Louiseville', 'Maskinongé', 'Mauricie', 'Macamic', 'Abitibi-Ouest', 'Abitibi-Témiscamingue', 'Magog', 'Memphrémagog', 'Estrie', 'Malartic', "La Vallée-de-l'Or", 'Abitibi-Témiscamingue', 'Maniwaki', 'La Vallée-de-la-Gatineau', 'Outaouais', 'Marieville', 'Rouville', 'Montérégie', 'Mascouche', 'Les Moulins', 'Lanaudière', 'Montréal', 'Matagami', 'Nord-du-Québec', 'Matane', 'La Matanie', 'Bas-Saint-Laurent', 'Mercier', 'Roussillon', 'Montérégie', 'Montréal', 'Métabetchouan–Lac-à-la-Croix', 'Lac-Saint-Jean-Est', 'Saguenay–Lac-Saint-Jean', 'Métis-sur-Mer', 'La Mitis', 'Bas-Saint-Laurent', 'Mirabel', 'Laurentides', 'Montréal', 'Mont-Joli', 'La Mitis', 'Bas-Saint-Laurent', 'Mont-Laurier', 'Antoine-Labelle', 'Laurentides', 'Montmagny', 'Montmagny', 'Chaudière-Appalaches', 'Montreal', 'Montréal', 'Montréal', 'Montreal West', 'Montréal', 'Montréal', 'Montréal-Est', 'Montréal', 'Montréal', 'Mont-Saint-Hilaire', 'La Vallée-du-Richelieu', 'Montérégie', 'Montréal', 'Mont-Tremblant', 'Les Laurentides', 'Laurentides', 'Mount Royal', 'Montréal', 'Montréal', 'Murdochville', 'La Côte-de-Gaspé', 'Gaspésie–Îles-de-la-Madeleine', 'Neuville', 'Portneuf', 'Capitale-Nationale', 'Québec', 'New Richmond', 'Bonaventure', 'Gaspésie–Îles-de-la-Madeleine', 'Nicolet', 'Nicolet-Yamaska', 'Centre-du-Québec', 'Normandin', 'Maria-Chapdelaine', 'Saguenay–Lac-Saint-Jean', "Notre-Dame-de-l'Île-Perrot", 'Vaudreuil-Soulanges', 'Montérégie', 'Montréal', 'Notre-Dame-des-Prairies', 'Joliette', 'Lanaudière', 'Otterburn Park', 'La Vallée-du-Richelieu', 'Montérégie', 'Montréal', 'Paspébiac', 'Bonaventure', 'Gaspésie–Îles-de-la-Madeleine', 'Percé', 'Le Rocher-Percé', 'Gaspésie–Îles-de-la-Madeleine', 'Pincourt', 'Vaudreuil-Soulanges', 'Montérégie', 'Montréal', 'Plessisville', "L'Érable", 'Centre-du-Québec', 'Pohénégamook', 'Témiscouata', 'Bas-Saint-Laurent', 'Pointe-Claire', 'Montréal', 'Montréal', 'Pont-Rouge', 'Portneuf', 'Capitale-Nationale', 'Port-Cartier', 'Sept-Rivières', 'Côte-Nord', 'Portneuf', 'Portneuf', 'Capitale-Nationale', 'Prévost', 'La Rivière-du-Nord', 'Laurentides', 'Princeville', "L'Érable", 'Centre-du-Québec', 'Québec', 'Capitale-Nationale', 'Québec', 'Repentigny', "L'Assomption", 'Lanaudière', 'Montréal', 'Richelieu', 'Rouville', 'Montérégie', 'Montréal', 'Richmond', 'Le Val-Saint-François', 'Estrie', 'Rigaud', 'Vaudreuil-Soulanges', 'Montérégie', 'Montréal', 'Rimouski', 'Rimouski-Neigette', 'Bas-Saint-Laurent', 'Rivière-du-Loup', 'Rivière-du-Loup', 'Bas-Saint-Laurent', 'Rivière-Rouge', 'Antoine-Labelle', 'Laurentides', 'Roberval', 'Le Domaine-du-Roy', 'Saguenay–Lac-Saint-Jean', 'Rosemère', 'Thérèse-De Blainville', 'Laurentides', 'Montréal', 'Rouyn-Noranda', 'Abitibi-Témiscamingue', 'Saguenay', 'Saguenay–Lac-Saint-Jean', 'Saint-Augustin-de-Desmaures', 'Capitale-Nationale', 'Québec', 'Saint-Basile', 'Portneuf', 'Capitale-Nationale', 'Saint-Basile-le-Grand', 'La Vallée-du-Richelieu', 'Montérégie', 'Montréal', 'Saint-Bruno-de-Montarville', 'Montérégie', 'Montréal', 'Saint-Césaire', 'Rouville', 'Montérégie', 'Saint-Charles-Borromée', 'Joliette', 'Lanaudière', 'Saint-Colomban', 'La Rivière-du-Nord', 'Laurentides', 'Montréal', 'Saint-Constant', 'Roussillon', 'Montérégie', 'Montréal', 'Sainte-Adèle', "Les Pays-d'en-Haut", 'Laurentides', 'Sainte-Agathe-des-Monts', 'Les Laurentides', 'Laurentides', 'Sainte-Anne-de-Beaupré', 'La Côte-de-Beaupré', 'Capitale-Nationale', 'Sainte-Anne-de-Bellevue', 'Montréal', 'Montréal', 'Sainte-Anne-des-Monts', 'La Haute-Gaspésie', 'Gaspésie–Îles-de-la-Madeleine', 'Sainte-Anne-des-Plaines', 'Thérèse-De Blainville', 'Laurentides', 'Montréal', 'Sainte-Catherine', 'Roussillon', 'Montérégie', 'Montréal', 'Sainte-Catherine-de-la-Jacques-Cartier', 'La Jacques-Cartier', 'Capitale-Nationale', 'Québec', 'Sainte-Julie', "Marguerite-D'Youville", 'Montérégie', 'Montréal', 'Sainte-Marguerite-du-Lac-Masson', "Les Pays-d'en-Haut", 'Laurentides', 'Sainte-Marie', 'La Nouvelle-Beauce', 'Chaudière-Appalaches', 'Sainte-Marthe-sur-le-Lac', 'Deux-Montagnes', 'Laurentides', 'Montréal', 'Sainte-Thérèse', 'Thérèse-De Blainville', 'Laurentides', 'Montréal', 'Saint-Eustache', 'Deux-Montagnes', 'Laurentides', 'Montréal', 'Saint-Félicien', 'Le Domaine-du-Roy', 'Saguenay–Lac-Saint-Jean', 'Saint-Gabriel', "D'Autray", 'Lanaudière', 'Saint-Georges', 'Beauce-Sartigan', 'Chaudière-Appalaches', 'Saint-Hyacinthe', 'Les Maskoutains', 'Montérégie', 'Saint-Jean-sur-Richelieu', 'Le Haut-Richelieu', 'Montérégie', 'Saint-Jérôme', 'La Rivière-du-Nord', 'Laurentides', 'Montréal', 'Saint-Joseph-de-Beauce', 'Robert-Cliche', 'Chaudière-Appalaches', 'Saint-Joseph-de-Sorel', 'Pierre-De Saurel', 'Montérégie', 'Saint-Lambert', 'Montérégie', 'Montréal', 'Saint-Lazare', 'Vaudreuil-Soulanges', 'Montérégie', 'Montréal', 'Saint-Lin-Laurentides', 'Montcalm', 'Lanaudière', 'Saint-Marc-des-Carrières', 'Portneuf', 'Capitale-Nationale', 'Saint-Ours', 'Pierre-De Saurel', 'Montérégie', 'Saint-Pamphile', "L'Islet", 'Chaudière-Appalaches', 'Saint-Pascal', 'Kamouraska', 'Bas-Saint-Laurent', 'Saint-Pie', 'Les Maskoutains', 'Montérégie', 'Saint-Raymond', 'Portneuf', 'Capitale-Nationale', 'Saint-Rémi', 'Les Jardins-de-Napierville', 'Montérégie', 'Saint-Sauveur', "Les Pays-d'en-Haut", 'Laurentides', 'Saint-Tite', 'Mékinac', 'Mauricie', 'Salaberry-de-Valleyfield', 'Beauharnois-Salaberry', 'Montérégie', 'Schefferville', 'Caniapiscau', 'Côte-Nord', 'Scotstown', 'Le Haut-Saint-François', 'Estrie', 'Senneterre', "La Vallée-de-l'Or", 'Abitibi-Témiscamingue', 'Sept-Îles', 'Sept-Rivières', 'Côte-Nord', 'Shawinigan', 'Mauricie', 'Sherbrooke', 'Estrie', 'Sorel-Tracy', 'Pierre-De Saurel', 'Montérégie', 'Stanstead', 'Memphrémagog', 'Estrie', 'Sutton', 'Brome-Missisquoi', 'Montérégie', 'Témiscaming', 'Témiscamingue', 'Abitibi-Témiscamingue', 'Témiscouata-sur-le-Lac', 'Témiscouata', 'Bas-Saint-Laurent', 'Terrebonne', 'Les Moulins', 'Lanaudière', 'Montréal', 'Thetford Mines', 'Les Appalaches', 'Chaudière-Appalaches', 'Thurso', 'Papineau', 'Outaouais', 'Trois-Pistoles', 'Les Basques', 'Bas-Saint-Laurent', 'Trois-Rivières', 'Mauricie', 'Valcourt', 'Le Val-Saint-François', 'Estrie', "Val-d'Or", "La Vallée-de-l'Or", 'Abitibi-Témiscamingue', 'Val-des-Sources', 'Les Sources', 'Estrie', 'Varennes', "Marguerite-D'Youville", 'Montérégie', 'Montréal', 'Vaudreuil-Dorion', 'Vaudreuil-Soulanges', 'Montérégie', 'Montréal', 'Victoriaville', 'Arthabaska', 'Centre-du-Québec', 'Ville-Marie', 'Témiscamingue', 'Abitibi-Témiscamingue', 'Warwick', 'Arthabaska', 'Centre-du-Québec', 'Waterloo', 'La Haute-Yamaska', 'Montérégie', 'Waterville', 'Coaticook', 'Estrie', 'Westmount', 'Montréal', 'Montréal', 'Windsor', 'Le Val-Saint-François', 'Estrie', 'Estevan', 'Estevan No. 5', 'Flin Flon', 'Humboldt', 'Humboldt No. 370', 'Lloydminster', 'Britannia No. 502', 'Martensville', 'Corman Park No. 344', 'Meadow Lake', 'Meadow Lake No. 588', 'Melfort', 'Star City No. 428', 'Melville', 'Cana No. 214', 'Moose Jaw', 'Moose Jaw No. 161', 'North Battleford', 'North Battleford No. 437', 'Prince Albert', 'Prince Albert No. 461', 'Regina', 'Sherwood No. 159', 'Saskatoon', 'Corman Park No. 344', 'Swift Current', 'Swift Current No. 137', 'Warman', 'Corman Park No. 344', 'Weyburn', 'Weyburn No. 67', 'Yorkton', 'Orkney No. 244', 'Whitehorse']
listx1 = ['ON','QC','NS','NB','MB','PE','BC','SK','AB','NL','AU','NSW','QLD','SA','TAS','VIC','WA','ACT','NT','AQ','CX','CC','HM','NF']
opdata=[]
for indx,iloc in enumerate(loccsv_list):
    if not any(word in str(iloc) for word in listx1):
        opdata.append((indx,keys[indx],iloc))
print(len(opdata))
op_df=pd.DataFrame(opdata, columns =['indx1','prim_key2', 'loc1'])
op_df.to_csv("op_file1_2.csv")

new_list = []
for i in listx :
    new_list.append(i.lower())

opdata=[]
for indx,iloc in enumerate(loccsv_list):
    if not any(word in str(iloc).lower() for word in new_list):
        opdata.append((indx,keys[indx],iloc))
print(len(opdata))
op_df=pd.DataFrame(opdata, columns =['indx1','prim_key3', 'loc2'])
op_df.to_csv("op_file1_3.csv")







#created spider to crawl throuhg online pages to get the list of states and province in Canada and Australia

import scrapy


class CountriesSpider(scrapy.Spider):
    name = 'countries'
    allowed_domains = ['en.wikipedia.org/wiki']
    start_urls = ['https://en.wikipedia.org/wiki/List_of_cities_in_Australia']

    def parse(self, response):
        title = response.xpath("//h2/text()").getall()
        countries = response.xpath("//li/a/text()").getall()

        yield{
            'title': title,
            'countries' :countries
        }
        pass
